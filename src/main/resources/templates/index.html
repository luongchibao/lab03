<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Student Management - Lab03</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Font Awesome (ICON) -->
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background: #f4f6f9;
        }
        .navbar-brand {
            font-weight: 600;
        }
        .card {
            border: none;
            border-radius: 12px;
        }
        .table thead {
            background-color: #0d6efd;
            color: white;
        }
        .btn {
            border-radius: 8px;
        }
        .form-control, .input-group-text {
            border-radius: 8px;
        }
        footer {
            font-size: 14px;
        }
    </style>
</head>

<body>

<!-- NAVBAR -->
<nav class="navbar navbar-dark bg-primary mb-4">
    <div class="container">
        <span class="navbar-brand mb-0 h1">
            <i class="fa-solid fa-graduation-cap me-2"></i>
            Há»‡ thá»‘ng quáº£n lÃ½ sinh viÃªn
        </span>
    </div>
</nav>

<div class="container">
    <div class="row g-4">

        <!-- LEFT: STUDENT LIST -->
        <div class="col-md-8">
            <div class="card shadow-sm">
                <div class="card-body">

                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h5 class="mb-0">
                            <i class="fa-solid fa-list me-1"></i>
                            Danh sÃ¡ch sinh viÃªn
                        </h5>

                        <input type="number" id="searchId"
                               class="form-control w-50"
                               placeholder="ðŸ” TÃ¬m theo ID..."
                               onkeyup="searchById()">
                    </div>

                    <table class="table table-hover align-middle">
                        <thead>
                        <tr>
                            <th><i class="fa-solid fa-id-card me-1"></i> ID</th>
                            <th><i class="fa-solid fa-user me-1"></i> TÃªn</th>
                            <th><i class="fa-solid fa-cake-candles me-1"></i> Tuá»•i</th>
                            <th><i class="fa-solid fa-envelope me-1"></i> Email</th>
                            <th width="110"><i class="fa-solid fa-gear me-1"></i> HÃ nh Ä‘á»™ng</th>
                        </tr>
                        </thead>
                        <tbody id="studentTable"></tbody>
                    </table>

                </div>
            </div>
        </div>

        <!-- RIGHT: FORM -->
        <div class="col-md-4">
            <div class="card shadow-sm">
                <div class="card-body">

                    <h5 class="mb-3">
                        <i class="fa-solid fa-pen-to-square me-1"></i>
                        ThÃªm / Cáº­p nháº­t sinh viÃªn
                    </h5>

                    <div class="input-group mb-2">
                        <span class="input-group-text"><i class="fa-solid fa-id-card"></i></span>
                        <input id="id" class="form-control" placeholder="ID">
                    </div>

                    <div class="input-group mb-2">
                        <span class="input-group-text"><i class="fa-solid fa-user"></i></span>
                        <input id="name" class="form-control" placeholder="Há» tÃªn">
                    </div>

                    <div class="input-group mb-2">
                        <span class="input-group-text"><i class="fa-solid fa-cake-candles"></i></span>
                        <input id="age" class="form-control" placeholder="Tuá»•i">
                    </div>

                    <div class="input-group mb-3">
                        <span class="input-group-text"><i class="fa-solid fa-envelope"></i></span>
                        <input id="email" class="form-control" placeholder="Email">
                    </div>

                    <div class="d-grid gap-2">
                        <button type="button" class="btn btn-primary" onclick="addStudent()">
                            <i class="fa-solid fa-plus me-1"></i> ThÃªm sinh viÃªn
                        </button>

                        <button type="button" class="btn btn-warning" onclick="updateStudent()">
                            <i class="fa-solid fa-rotate me-1"></i> Cáº­p nháº­t sinh viÃªn
                        </button>
                    </div>

                </div>
            </div>
        </div>

    </div>
</div>

<!-- FOOTER -->
<footer class="text-center text-muted mt-5 mb-3">
    Lab03 â€“ Spring Boot REST API & Bootstrap UI
</footer>

<script>
const API = "/api/students";

// LOAD ALL
function loadStudents() {
    fetch(API)
        .then(res => res.json())
        .then(data => renderTable(data));
}

// ADD
function addStudent() {
    const student = getFormData();
    fetch(API, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(student)
    }).then(loadStudents);
}

// UPDATE
function updateStudent() {
    const student = getFormData();
    fetch(`${API}/update/${student.id}`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(student)
    }).then(loadStudents);
}

// DELETE
function deleteStudent(id) {
    fetch(`${API}/delete/${id}`, { method: "POST" })
        .then(loadStudents);
}

// SEARCH BY ID
function searchById() {
    const id = document.getElementById("searchId").value;
    if (id === "") {
        loadStudents();
        return;
    }

    fetch(`${API}/${id}`)
        .then(res => res.ok ? res.json() : null)
        .then(s => {
            if (!s) {
                document.getElementById("studentTable").innerHTML = "";
                return;
            }
            renderTable([s]);
        });
}

// RENDER TABLE
function renderTable(data) {
    let html = "";
    data.forEach(s => {
        html += `
        <tr>
            <td>${s.id}</td>
            <td>${s.name}</td>
            <td>${s.age}</td>
            <td>${s.email}</td>
            <td>
                <button class="btn btn-sm btn-outline-danger"
                        title="XÃ³a sinh viÃªn"
                        onclick="deleteStudent(${s.id})">
                    <i class="fa-solid fa-trash"></i>
                </button>
            </td>
        </tr>`;
    });
    document.getElementById("studentTable").innerHTML = html;
}

function getFormData() {
    return {
        id: document.getElementById("id").value,
        name: document.getElementById("name").value,
        age: document.getElementById("age").value,
        email: document.getElementById("email").value
    };
}

loadStudents();
</script>

</body>
</html>
